{% extends "base.html" %}
{% load staticfiles %}
{% load bootstrap3 %}
{% bootstrap_css %}
{% bootstrap_javascript %}
{% load i18n %}
{% load widget_tweaks %}

{% block head %}
{{block.super}}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
{{ form.media }}
{% endblock %}

{%block header%}
<div class="header">
    <div class="row">
        <div class="header-top">
            <img src="{% static 'images/logo.png' %}" alt="logo">
        </div>
        <div class="header-bottom create-event-block">
            <div class="container">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}


{% block content %}
<section section class="my-events-steps payment-content">
<div class="my-events-steps">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 menu">
                <ul class="nav nav-pills ">
                    <li role="presentation"><a href="{% url 'modify_event' event_name=event.subdomain %}"><span>STEP 1</span><span>Event details</span></a></li>
                
                <li role="presentation"><a href="{%url 'add_event_description' event_name=event.subdomain %}"><span>STEP 2</span><span>Event text</span></a></li>

                 <li role="presentation"><a href="{%url 'add_event_participants' event_name=event.subdomain %}"><span>STEP 3</span><span>Participant info</span></a></li>
                
                <li role="presentation"> <a href="{%url 'add_event_companion' event_name=event.subdomain %}"><span>STEP 4</span><span>Companions</span></a></li>
                
                <li role="presentation" ><a href="{%url 'add_event_lectures' event_name=event.subdomain %}"><span>STEP 5</span><span>Agenda</span></a></li>
                
                <li role="presentation"><a href="{%url 'add_event_payment' event_name=event.subdomain %}"><span>STEP 6</span><span>Payment</span></a></li>

                <li role="presentation" class="active"><a href="{%url 'card_designer' event_name=event.subdomain %}" ><span>STEP 7</span><span>Card designer</span></a></li>
                </ul>  
                <div class="tab-content">
                <div id="step7" class="tab-pane fade in active">
                  <h3>STEP 7 Card Designer</h3>
<!-- <div class="row">
  <br>
  <div class=" col-md-1">
  </div>
  <div class=" col-md-1">
    <button type="submit" class="btn btn-primary btn-sx" style="vertical-align: middle" id="print">
                       {% trans "Print" %}
    </button>
  </div>
    <div class=" col-md-1">
    <form method="POST" action="#">  
          {% csrf_token %}
          <button type="submit" class="btn btn-primary btn-sx" style="vertical-align: middle" id="saveOutlook">
                       {% trans "Save outlook" %}
          </button>
    </form>
  </div>
</div> -->
<div class="col-xs-12">
      <br/><br/>
      <div class="col-xs-12 col-sm-4 col-md-4">
        <div class="promotion-radio">
          <span class='radio'>
            <input type='radio' name='cardType' id="r1" value="1" checked="checked"/>
            <label for='r1'><span></span>Design 1</label>
          </span>
        </div>
        <br><br>
        <div class="card-design">
          <ul>
            <li id="companyInfo1" class="card-style text-center card-title" title="Company info"><div id="companyInfoText1"><span class="red-card">ID</span>.Conference</div></li>
            <li id="personalInfo1" class="card-style text-center personal-info" title="Personal info"><div id="personalInfoText1">TOMAŽ JURIČ<br/>IDentiks d.o.o.</div></li>
            <li id="barcode1" class="card-style barcode-1"><img src="{% static 'images/barcode-horizontal.png' %}"></li>
          </ul>
        </div>
      </div>  

      <div class="col-xs-12 col-sm-4 col-md-4">
          <div class="promotion-radio">
            <span class='radio'>
              <input type='radio' id='r2' name='cardType' value="2"/>
              <label for='r2'><span></span>Design 2</label>
            </span>
          </div>
        <br><br>
        <div id="wrapper2" class="card-design">
          <div class="col-xs-8 card-second">
            <ul>
                <li id="companyInfo1" class="card-style text-left card-title" title="Company info"><div id="companyInfoText1"><span class="red-card">ID</span>.Conference</div></li>
                <li id="personalInfo1" class="card-style text-left personal-info" style="position: absolute; bottom: 25px;" title="Personal info"><div id="personalInfoText1">TOMAŽ JURIČ<br/>IDentiks d.o.o.</div></li>
            </ul>
          </div>  
          <div id="barcode" class="card-style barcode-verical"><img src="{% static 'images/barcode-vertical.png' %}"></div>
        </div>  
      </div>  

      <div class="col-xs-12 col-sm-4 col-md-4">
          <div class="promotion-radio">
            <span class='radio'>
              <input type='radio' id='r3' name='cardType' value="3"/>
              <label for='r3'><span></span>Design 3</label>
            </span>
          </div>
          <br><br>
          <div id="wrapper3" class="card-design">
            <div class="card-style barcode-verical-second"><img src="{% static 'images/barcode-vertical.png' %}"></div>
              <div class="col-xs-8 card-second" style="float: right !important;">
                <ul>
                    <li id="companyInfo1" class="card-style text-right card-title" title="Company info"><div id="companyInfoText1"><span class="red-card">ID</span>.Conference</div></li>
                    <li id="personalInfo1" class="card-style text-right personal-info" style="bottom: 25px;" title="Personal info"><div id="personalInfoText1">TOMAŽ JURIČ<br/>IDentiks d.o.o.</div></li>
                </ul>
              </div>
            </div>  
          </div>  
        </div> 
  <label class="container text-center">
    <br>
    <br>
    
    <h4>You can create your own composition by moving the fields</h4>
  </label>
  <br/>
  <br/>
  <br/>
  <div class="col-xs-12" id="centerDiv">
    <div class="col-xs-2"></div>
    <div class='col-xs-8'>

      <div id='wrapper1L' class="card-viewer">
        <div id='sortable1L' style='height:270px'>
          <div id='companyInfo1L' style='height:70px' title='Company info'>
            <div id="companyInfoText11L" class="preview-card text-center"><span class="red-card">ID</span>.Conference</div>
            <textarea id='companyInfoText1L' class="hidden" style='width:99%;height:99%;resize:none;overflow:hidden;font-size:19px;text-align: center;'><span class="red-card">ID</span>.Conference</textarea>
          </div>
          <div id='personalInfo1L' style='height:134.15px' title='Personal info'>
              <div id="personalInfoText11L" class="preview-card text-center">TOMAŽ JURIČ<br/>IDentiks d.o.o.</div>
             <textarea id='personalInfoText1L' class="hidden" style='width:99%;height:99%;resize:none;overflow:hidden;font-size:19px;text-align: center;'>TOMAŽ JURIČ<br/>IDentiks d.o.o.</textarea>
          </div>
        </div>
        <div id='barcode1L' class='card-style' style='height:103.7px;width:92%'>
          <img src="{% static 'images/barcode-horizontal.png' %}">
        </div>
      </div>

      <div id='wrapper2L' class="card-viewer" style="display: none;">
        <div id='sortable2DivL' style='height:270px'>
          <div id='sortable2L'>
            <div id='companyInfo2L' style='width:420px;height:134.15px'>
                <div id="companyInfoText22L" class="preview-card text-left"><span class="red-card">ID</span>.Conference</div>
              <textarea id='companyInfoText2L' class="hidden" style='width:99%;height:99%;resize:none;overflow:hidden;font-size:19px'>Event/Company information</textarea>
            </div>
            <div id='personalInfo2L' style='width:420px;height:108px;'>
                <div id="personalInfoText22L" class="preview-card text-left">TOMAŽ JURIČ<br/>IDentiks d.o.o.</div>
              <textarea id='personalInfoText2L' class="hidden" style='width:99%;height:99%;resize:none;overflow:hidden;font-size:19px'>TOMAŽ JURIČ<br/>IDentiks d.o.o.
              </textarea>
            </div>
          </div>
        </div>
        <div id='barcode2L' class='card-style' style='height:167.5px;width:104.7px;float:right'>
            <img src="{% static 'images/barcode-vertical.png' %}">
        </div>
      </div>

      <div id='wrapper3L' class="card-viewer" style='display:none;'>
        <div style="height:270px;">
          <div id='barcode3L' class='card-style' style='height:167.5pxpx;width:104.7px;float:left'>
              <img src="{% static 'images/barcode-vertical.png' %}">
          </div>
          <div id='sortable3DivL' style='float:left'>
            <div id='sortable3L' style='width:492px;height:377px;'>
              <div id='companyInfo3L' style='width:590px;height:134px;'>
                  <div id="companyInfoText33L" class="preview-card text-right"><span class="red-card">ID</span>.Conference</div>
                <textarea id='companyInfoText3L' class="hidden" style='width:99%;height:99%;resize:none;overflow:hidden;font-size:19px'><span class="red-card">ID</span>.Conference
                </textarea>
              </div>
              <div id='personalInfo3L' style='width:590px;height:108px;'>
                  <div id="personalInfoText33L" class="preview-card text-right">TOMAŽ JURIČ<br/>IDentiks d.o.o.</div>
                <textarea id='personalInfoText3L' class="hidden" style='width:99%;height:99%;resize:none;overflow:hidden;font-size:19px'>TOMAŽ JURIČ<br/>IDentiks d.o.o.
                </textarea>
              </div>
            </div>
        </div>
        </div><!-- end of sortable3DivL-->
        
        </div><!-- end of class='col-md-10 col-md-offset-2' -->
      </div><!-- end of row -->
      <div class="col-xs-2"></div>

  </div><!-- end of centerDiv-->
  <br> 
  <br> 
  <div class="col-xs-12 text-center preview">
    <button type="submit" class="btn btn-primary btn-lg" id="preview">
        {% trans "PREVIEW" %}
    </button>
  </div>
  <br> 
  <br>
  <div class="col-xs-12">
    <h3>Settings:</h3> 
    <div class="col-md-6">
      <h4 style="margin-right: 0 !important; margin-left: 0 !important; color: #555 !important; font-weight: normal;">Edit company text</h4>
      <br>
      <div class="form-group">
        <label for="fontType" style="font-size: 18px !important;">Font type:</label>
         <select class="form-control" id="fontTypeCompany">
          <option value="Times New Roman">Times new roman</option>
          <option value="Georgia">Georgia</option>
          <option value="Arial">Arial</option>
          <option value="Verdana">Verdana</option>
          <option value="Courier New">Courier New</option>
          <option value="Lucida Console">Lucida Console</option>
      </select>
      </div>
      <div class="form-group">
          <label for="fontSize" style="font-size: 18px !important;">Font size:</label>
          <select class="form-control" id="fontSizeCompany">
              <option value="19px">Small</option>
              <option value="27px">Medium</option>
              <option value="35px">Large</option>
          </select>
      </div>   
    </div> 
    <div class="col-md-6">
      <h4 style="padding-right: 0 !important; padding-left: 0 !important; color: #555 !important; font-weight: normal;">Edit personal text</h4>
      <br>
      <div class="form-group">
        <label for="fontType" style="font-size: 18px !important;">Font type:</label>
         <select class="form-control" id="fontTypePersonal">
          <option value="Times New Roman">Times new roman</option>
          <option value="Georgia">Georgia</option>
          <option value="Arial">Arial</option>
          <option value="Verdana">Verdana</option>
          <option value="Courier New">Courier New</option>
          <option value="Lucida Console">Lucida Console</option>
      </select>
      </div>
      <div class="form-group">
          <label for="fontSize" style="font-size: 18px !important;">Font size:</label>
          <select class="form-control" id="fontSizePersonal">
              <option value="19px">Small</option>
              <option value="27px">Medium</option>
              <option value="35px">Large</option>
          </select>
      </div>   
    </div>   
</div>
  <br>  
    <div class="col-xs-12">
                        <div class="col-sm-6 col-md-6 col-lg-6 text-right save-next-content pull-right">
                                <div class="next-btn">
                                     <a href="{% url 'list_events' %}" class="btn"><img src="{% static 'images/next-btn.png' %}" alt="delete"><span>{% trans "FINISH" %}</span></a>    
                                </div>
                            </div>

                    <div class="col-sm-2 col-md-2 col-lg-2 delete-content">
                        <a href="#" class="btn" data-toggle="modal" data-target="#deleteModal"><img src="{% static 'images/delete.png' %}" alt="delete"><span>{% trans "DELETE" %}</span></a>
                    </div>

                              <!-- Modal -->
                        <div class="modal fade" id="deleteModal" role="dialog">
                          <div class="modal-dialog">
                          
                            <!-- Modal content-->
                            <div class="modal-content">
                              <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">Delete event</h4>
                              </div>
                              <div class="modal-body">
                                <p>Are you sure you want to delete the event? All the lectures and payment methdos, bounded to the event
                                  will be deleted as well.</p>
                              </div>
                              <div class="modal-footer">
                                <a href="#" id="buttonDelete" name="{{event.subdomain}}" class="btn btn-default" data-dismiss="modal">Delete</a>
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                              </div>
                            </div>
                            
                          </div>
                        </div>
                            <div class="col-sm-4 col-md-4 col-lg-4 save-back-content">
                                <a href="{% url 'list_events' %}" class="btn"><img src="{% static 'images/download.png' %}" alt="download"><span>{% trans 'SAVE AND GO BACK TO THE EVENT LIST' %}</span></a>
                            </div>
                        <script> 
                        $('#buttonDelete').on('click', function(e) {
                          e.preventDefault();
                          var name = $(this).data('name');
                          $.ajax({
                              url:  "{% url 'delete_event' event_name=event.subdomain %}",
                              type: 'GET',
                              success: function(html){
                                parent.window.location="{% url 'list_events' %}";
                              },
                              error: function(){
                                  alert("error");
                              }  
                          });  
                      });
                  </script>             
            </div>   
        </div>
    </div>


<script type="text/javascript">
        

        $(function() {

          //global definition variables
          widthCm = 8.6;
          heightCm = 5.4;
          //the ratio between width and height is 8.6/5.4 = 1.6
          widthPx = 600;
          heightPx = 377;

          //when any of option is clicked, show the right magnified div in the cetner of the page
          $("input[name='cardType']").change(function() {
              
              var type = $("input[name='cardType']:checked").val();
              if (type == 1) {
                $("#wrapper1L").show();
                $("#wrapper2L").hide();
                $("#wrapper3L").hide();
              }
              if (type == 2) {
                $("#wrapper1L").hide();
                $("#wrapper2L").show();
                $("#wrapper3L").hide();
              }
              if (type == 3) {
                $("#wrapper1L").hide();
                $("#wrapper2L").hide();
                $("#wrapper3L").show();
              }
          });

          $("#print").click(function() {
            
            if ($("input[name='cardType']:checked").val()){

            var type = $("input[name='cardType']:checked").val();

            var ratios = new Array();

              if (type == 1) { 
                var ratios = calculateRatio(1);
                var orderC = ratios['cOrder'];
                var orderP = ratios['pOrder'];
                var orderC = ratios['bOrder']; 
                console.log('vsota inside print n1'); 
                console.log(ratios[0].value[1]+ratios[1].value[1]+ratios[2].value[1]);
                var mywindow1 = window.open('', 'PRINT', 'height=400,width=600');

                var template1 = 
                  "<div id='preview-modal' style='width:8.6cm;height:5.4cm;'><div style='font-size:"+ ratios[0].value[6] +";font-family:" + ratios[0].value[5] + "position:absolute;margin-left:" + ratios[0].value[0]  +"cm;top:" + ratios[0].value[1] + "cm;width:" + ratios[0].value[2] +"cm ;height:" + ratios[0].value[3] +"cm'>" + ratios[0].value[4] + "</div><div style='position:absolute;font-family:"+ ratios[0].value[5] + ";margin-left:" + ratios[1].value[0]  +"cm;top:" + ratios[1].value[1] + "cm;width:" + ratios[1].value[2] + "cm ;height:" + ratios[1].value[3] +"cm;font-size:"+ ratios[1].value[6] +"'>" + ratios[1].value[4] + "</div><div style='border:0.01cm solid;position:absolute;margin-left:" + ratios[2].value[0]  +"cm;top:" + ratios[2].value[1] + "cm;width:2.4cm;height:1.5cm'></div></div>";
                mywindow1.document.write(template1);
                mywindow1.print();
                mywindow1.close();
              }
              if (type == 2) {
                var ratios = calculateRatio(2);
                var orderC = ratios['cOrder'];
                var orderP = ratios['pOrder'];
                //8.6cm - 
                var mywindow2 = window.open('', 'PRINT', 'height=400,width=600');

                console.log('check');
                console.log(Math.round(ratios[2].value[0],3));
                console.log(Math.round(ratios[2].value[0],3) + 2.4);

                var template2 = "<div style='margin:0 0 0 0; width:8.6cm;height:5.4cm'><div style='position:absolute;float:left;width:6.9cm;height:5.4cm'><div style='font-family:" + ratios[0].value[5] + ";font-size:"+ ratios[0].value[6] +"margin-left:" + ratios[0].value[0] + "cm;top:" + ratios[0].value[1] + "cm;width:" + ratios[0].value[2] + "cm;height:" + ratios[0].value[3] +"cm'>" + ratios[0].value[4] + "</div><div style='font-family:" + ratios[0].value[5] +";font-size:"+ ratios[0].value[6] +"position:absolute;margin-left:"+ ratios[1].value[0] + "cm;top:" + ratios[1].value[1] + "cm;width:" + ratios[1].value[2] + "cm;height:" + ratios[1].value[3] + "cm'>" + ratios[1].value[4] + "</div></div><div style='border:0.01cm solid;float:right;width:1.5cm;height:2.4cm;margin-top:" + ratios[2].value[0] + "cm'><img src='{% static "barcode90.png" %}'></div></div>";

                mywindow2.document.write(template2);
                mywindow2.print();
                mywindow2.close();
              }
              if (type == 3) {
                var ratios = calculateRatio(3);
                var orderC = ratios['cOrder'];
                var orderP = ratios['pOrder'];

                var mywindow3 = window.open('', 'PRINT', 'height=400,width=600');

                var template3 = 
                "<div style='width:8.6cm;height:5.4cm'><div style='border:0.01cm solid;float:left;width:1.5.3cm;height:2.4cm;top:" + ratios[2].value[0] + "cm'><img src='{% static "barcode180.png" %}'  /></div><div style='float:right;width:6.9cm;height:5.4cm'><div style='font-family:" + ratios[0].value[5] + ";font-size:"+ ratios[0].value[6] +";margin-left:" + ratios[0].value[0] + ";top:" + ratios[0].value[1] + "cm;width:" + ratios[0].value[2] + "cm;height:" + ratios[0].value[3] +"cm'>" + ratios[0].value[4] + "</div><div style='font-family"+ ratios[1].value[5] +";font-size:" + ratios[1].value[6] + ";margin-left:"+ ratios[1].value[0] + "cm;top:" + ratios[1].value[1] + "cm;width:" + ratios[1].value[2] + "cm;height:" + ratios[1].value[3] + "cm'>" + ratios[1].value[4] + "</div></div></div>"; 
                mywindow3.document.write(template3);
                mywindow3.print();
                mywindow3.close();
              }
            } else {
              alert('You need to select one of the card type options');
            }   
          });
        });
        //preview function
        $( "#preview" ).button().on( "click", function() {
            if ($("input[name='cardType']:checked").val()){

              var type = $("input[name='cardType']:checked").val();
              var ratios = new Array();
              var ratios = calculateRatio(type);
              console.log(ratios);

              if (type == 1) {

                var orderC = ratios['cOrder'];
                var orderP = ratios['pOrder'];
                var orderC = ratios['bOrder'];  
                //company info is first

                var template = 
                "<div id='preview-modal' style='width:8.6cm; height:5.4cm; box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);transition: 0.3s;border-radius: 0.1cm;' title='Preview'><div style='font-family:"+ ratios[0].value[5] +";font-size:" + ratios[0].value[6] + ";position:absolute;margin-left:" + ratios[0].value[0]  +"cm;top:0.5cm;text-align: center;width:" + ratios[0].value[2] +"cm ;height:" + ratios[0].value[3] +"cm'>" + ratios[0].value[4] + "</div><div style='font-family:"+ ratios[1].value[5] +";font-size:"+ ratios[1].value[6] +";position:absolute;margin-left:" + ratios[1].value[0]  +"cm;top:2cm;text-align: center;width:" + ratios[1].value[2] + "cm ;height:" + ratios[1].value[3] +"cm'>" + ratios[1].value[4] + "</div><div style='position:absolute;margin-left:" + ratios[2].value[0]  +"cm;top:3cm;width:" + ratios[2].value[2] + "cm ;text-align:center;height:" + ratios[2].value[3] +"cm'>" + ratios[2].value[4] + "</div><img style='width: 80px;position: absolute;bottom: 80px;margin-left: 120px;' src='{% static 'images/barcode-horizontal.png' %}'></div>";
              }
              if (type == 2) {

                var orderC = ratios['cOrder'];
                var orderP = ratios['pOrder'];
                //8.6cm - 
                var template = 
                "<div style='border:1px solid;width:8.6cm;height:5.4cm;box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);transition: 0.3s;border-radius:0.1cm;'><div style='position:absolute;float:left;width:6.9cm;height:5.4cm'><div style='font-family:"+ ratios[0].value[5] +";font-size:"+ ratios[0].value[6] +";margin-left:0.5cm;margin-top:0.5cm;top:0.5cm;width:" + ratios[0].value[2] + "cm;height:" + ratios[0].value[3] +"cm'>" + ratios[0].value[4] + "</div><div style='font-family:"+ ratios[1].value[5] +";font-size:"+ ratios[1].value[6] +";position:absolute;margin-left:0.5cm;top:2.5cm;width:" + ratios[1].value[2] + "cm;height:" + ratios[1].value[3] + "cm'>" + ratios[1].value[4] + "</div></div><div style='float:right;width:1.5cm;height:2.4cm;margin-top:" + ratios[2].value[0] + "cm'><img style='width: 40px;position: absolute;' src='{% static 'images/barcode-vertical.png' %}'></div></div>";  
              }

              if (type == 3) {

                var orderC = ratios['cOrder'];
                var orderP = ratios['pOrder'];

                var template = 
                "<div style='width:8.6cm;height:5.4cm;box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);transition: 0.3s;border-radius:0.1cm;'><div style='float:left;width:1.5cm;height:2.4cm;margin-top:" + ratios[2].value[0] + "cm'><img src='{% static '/test' %}'  /></div><div style='position:absolute;float:right;width:6.9cm;height:5.4cm'><div style='font-family:"+ ratios[0].value[5] +";font-size:"+ ratios[0].value[6] +";top:0.5cm;position: absolute;text-align: right;padding-right: 10px;width:" + ratios[0].value[2] + "cm;height:" + ratios[0].value[3] +"cm'>" + ratios[0].value[4] + "</div><div style='font-family:"+ ratios[1].value[5] +";font-size:"+ ratios[1].value[6] + ";position:absolute;top:3cm;width:" + ratios[1].value[2] + "cm;text-align:right;padding-right: 10px;height:" + ratios[1].value[3] + "cm'>" + ratios[1].value[4] + "</div></div><img style='width: 40px;position: absolute;bottom: 80px;left: 30px;' src='{% static 'images/barcode-vertical.png' %}'></div>";  
              }
              

              //buiding the dialog window
              dialog = $( "<div>" + template + "</div>" ).dialog({
                autoOpen: false,
                height: 400,
                width: 500,
                modal: true,
                buttons: {
                  Ok: function() {
                    dialog.dialog( "close" );
                  }
                }
              });
              dialog.dialog( "open" );
            }
            else {
              alert('You need to select one of the card type options');
            }  
        }); //end preview

        $( "#saveOutlook" ).button().on( "click", function(e) {
            e.preventDefault();
            if ($("input[name='cardType']:checked").val() > 0){

              var type = $("input[name='cardType']:checked").val();
              var ratios = new Array();
              var ratios = calculateRatio(type);

              var resultObject = {};
              resultObject.type = type;
              resultObject.subdomain = "{{event.subdomain}}";

              resultObject.company = {}
              resultObject.company.top = ratios[0].value[0];
              resultObject.company.left = ratios[0].value[1];
              resultObject.company.width = ratios[0].value[2];    
              resultObject.company.height = ratios[0].value[3];
              resultObject.company.text = ratios[0].value[4];
              resultObject.company.type = ratios[0].value[5];
              resultObject.company.size = ratios[0].value[6];

              resultObject.personal = {}
              resultObject.personal.top = ratios[1].value[0];
              resultObject.personal.left = ratios[1].value[1];
              resultObject.personal.width = ratios[1].value[2];    
              resultObject.personal.height = ratios[1].value[3];
              resultObject.personal.text = ratios[1].value[4];
              resultObject.personal.type = ratios[1].value[5];
              resultObject.personal.size = ratios[1].value[6];

              resultObject.barcode = {}
              resultObject.barcode.top = ratios[2].value[0];
              resultObject.barcode.left = ratios[2].value[1];
              resultObject.barcode.width = ratios[2].value[2];    
              resultObject.barcode.height = ratios[2].value[3];

              console.log(resultObject);
              var token = $('input[name=csrfmiddlewaretoken]').val();

              $.ajax({
                type: "POST",
                url: "{% url 'save_card_outlook' %}",
                data: {
                  data: JSON.stringify(resultObject),
                  subdomain: "{{event.subdomain}}",
                  csrfmiddlewaretoken: token
                },
                success: function () {
                  alert("successfully saved");
                },
                error: function () {
                  alert("error, try again");
                }
              });


            } 
            else {
              alert('You need to select one of the card type options');
            }
        });     

        $( function() {

            //the full height is 187.5px
            //the 1.95cm+1.95cm+1.5cm=5.4 (since the height of barcode is 1.5cm) / the ratio is 0.36/0.36./0.28
            //in pixels that is 67.5+67.5+52.2 = 187.5px
            //global variables for the first option of card 
            //2.4cm is the width of the barcode: the ratio is 2.4cm/8.6cm = 0.28; in pixels that is 84px

            //the full height is 377px
            //barcode height is 104.7px
            //377 - 104.7 = 272.3
            //272.3/2 = 136.15

            var dataBlock1Height = 136.15;
            var barcode1Width = 167.5;
            var barcode1Height = 104.7;

            //the full height is 377px
            //for options 2 and 3
            //377/2 = 188.5px

            var dataBlockHeight = 
            
            $( "#companyInfo1L, #companyInfo11L" ).resizable({
                 handles: 'n, e, s, w',
                 grid: 10,
                 maxHeight: 200,
                 maxWidth: 592,
                 minHeight: 40,
                 minWidth: 150,
                 containment: 'parent',
                 start: function(event, ui) {
                    previousSize = ui.size.height;
                 },
                 stop: function(event, ui) {
                    var direction = $(this).data('ui-resizable').axis;
                    if (direction == 's'){
                      var currentSizeP1 = ui.size.height;
                      var heightOfC1 = $("#companyInfo1L").outerHeight();
                      var heightOfP1 = $("#personalInfo1L").outerHeight();
                      var topMargin = parseInt($("#personalInfo1L").css('top'));
                      console.log('heightOfC1: ' + heightOfC1);
                      console.log('heightOfP1: ' + heightOfP1);
                      console.log('top margin: ' + topMargin);
                      var sum = heightOfC1 + heightOfP1 + topMargin;
                      if (sum > 270){
                          var currentSize = ui.size.height;
                          $( "#personalInfo1L" ).css({'top':'10px'});
                      }
                      //2xmargin top (2x5px) + 2xmargin bottom(2x5px) + 4x1px for borders = 24px
                      //var size = heightPx - barcode1Height - ui.size.height;
                      //if (previousSize<currentSize) {
                          //$( "#personalInfo1L" ).height(size);
                      //}
                    }  
                }
            });
            $( "#personalInfo1L, #personalInfo11L" ).resizable({
                 handles: 'n, e, s, w',
                 grid: 10,
                 maxHeight: 200,
                 maxWidth: 592,
                 minHeight: 40,
                 minWidth: 150,
                 containment: 'parent',
                 start: function(event, ui) {
                    previousSize = ui.size.height;
                 },
                 stop: function(event, ui) {
                    var direction = $(this).data('ui-resizable').axis;
                    if (direction == 's'){
                      //var currentSize = ui.size.height;
                      //2xmargin top (2x5px) + 2xmargin bottom(2x5px) + 4x1px for borders = 24px
                      //var size = heightPx - barcode1Height - ui.size.height;
                      //if (previousSize<currentSize) {
                        //$( "#companyInfo1L" ).height(size);
                      //}
                    }
                }
            });
            
            $('#barcode1L,barcode2L,barcode3L, companyInfo2L, companyInfo3L, companyInfo1L, personalInfo1L, personalInfo2L, personalInfo3L').draggable( {
                containment: 'parent',
                axis: "x, y",
            } );

            $( "#companyInfo2L,#companyInfo22L" ).resizable({
                 handles: 'n,e,s,w',
                 containment: 'parent', 
                 grid: 10,
                 maxHeight: 250,
                 maxWidth: 492,
                 minHeight: 50,
                 minWidth: 100,
                 stop: function(event, ui) {
                    var direction = $(this).data('ui-resizable').axis;
                    if (direction == 's'){
                      var size = heightPx - ui.size.height -19;
                      var currentSizeP2 = ui.size.height;
                      var heightOfC2 = $("#companyInfo2L").outerHeight();
                      var heightOfP2 = $("#personalInfo2L").outerHeight();
                      var topMargin = parseInt($("#personalInfo2L").css('top'));
                      var sum = heightOfC2 + heightOfP2 + topMargin;
                      //var sumC2 = currentSizeP2 + sizeOfC2;
                      if (sum > 377) {
                        console.log('je palu ven');
                        if (heightOfP2+topMargin > 350) {
                          $( "#personalInfo2L" ).height();
                          console.log('scenarij 1');
                          console.log('heightOfP2+topMargin', heightOfP2+topMargin)
                        }
                        else if ((heightOfP2 > 185) && (heightOfC2 > 185) ) {
                          $( "#personalInfo2L" ).css({'top':'10px'});
                          $( "#personalInfo2L" ).height();
                          console.log('scenarij 2');
                        }
                        else {
                          $( "#personalInfo2L" ).css({'top':'0px'});
                          console.log($( "#personalInfo2L" ).offset().top);
                          console.log('scenarij 3');
                        }
                      } 
                    }  
                  }
            });
            $( "#personalInfo2L, #personalInfo22L" ).resizable({
                 handles: 'n,e,s,w', 
                 containment: 'parent',
                 grid: 10,
                 maxHeight: 250,
                 maxWidth: 492,
                 minHeight: 50,
                 minWidth: 100,
                 stop: function(event, ui) {
                    var direction = $(this).data('ui-resizable').axis;
                    if (direction == 's'){
                      var currentSizeC2 = ui.size.height;
                      var barcode2 = $("#barcode2").outerHeight();
                      var heightOfC2 = $("#companyInfo2L").outerHeight();
                      var heightOfP2 = $("#personalInfo2L").outerHeight();
                      var topMargin = parseInt($("#personalInfo2L").css('top'));
                      var sum = heightOfC2 + heightOfP2 + topMargin;
                      if (sum > 377) {
                        var delta = sum - 377;
                        console.log('delta'+delta);
                        console.log('je palu ven');
                        //var size = heightPx  - ui.size.height -19;
                        if (heightOfP2+topMargin > 350) {
                          $( "#companyInfo2L" ).height();
                        }
                        else if ((heightOfP2 > 150) && (heightOfC2 > 150) ) {
                          $( "#companyInfo2L" ).height();
                        }
                        else {
                           $( "#companyInfo2L" ).css({'top':'20px'});
                           console.log($( "#companyInfo2L" ).offset().top);
                        }
                      }  
                    }  
                }
            });

            $('#barcode2L').draggable( {
                containment: 'parent',
                axis: "y",
            } );

            $( "#companyInfo3L, #companyInfo33L" ).resizable({
                 handles: 'n,e,s,w', 
                 containment:'parent',
                 grid: 10,
                 maxHeight: 250,
                 maxWidth: 492,
                 minHeight: 50,
                 minWidth: 100,
                 stop: function(event, ui) {
                    var direction = $(this).data('ui-resizable').axis;
                    if (direction == 's'){
                      var size = heightPx - ui.size.height -19;
                      var currentSizeP3 = ui.size.height;
                      var heightOfC3 = $("#companyInfo3L").outerHeight();
                      var heightOfP3 = $("#personalInfo3L").outerHeight();
                      var topMargin = parseInt($("#personalInfo3L").css('top'));
                      var sum = heightOfC3 + heightOfP3 + topMargin;
                      //var sumC2 = currentSizeP2 + sizeOfC2;
                      if (sum > 377) {
                        console.log('je palu ven');
                        if (heightOfP3+topMargin > 350) {
                          $( "#personalInfo3L" ).height();
                        }
                        else if ((heightOfP3 > 185) && (heightOfC3 > 185) ) {
                          $( "#personalInfo3L" ).css({'top':'10px'});
                          $( "#personalInfo3L" ).height();
                        }
                        else {
                          $( "#personalInfo3L" ).css({'top':'0px'});
                        }
                      } 
                    }  
                  } 
            });
            $( "#personalInfo3L, #personalInfo33L" ).resizable({
                 handles: 'n,e,s,w',
                 containment:'parent',
                 grid: 10,
                 maxHeight: 250,
                 maxWidth: 492,
                 minHeight: 50,
                 minWidth: 100,
                 stop: function(event, ui) {
                    var direction = $(this).data('ui-resizable').axis;
                    if (direction == 's'){
                      var currentSizeC3 = ui.size.height;
                      var barcode3 = $("#barcode3").outerHeight();
                      var heightOfC3 = $("#companyInfo3L").outerHeight();
                      var heightOfP3 = $("#personalInfo3L").outerHeight();
                      var topMargin = parseInt($("#personalInfo3L").css('top'));
                      var sum = heightOfC3 + heightOfP3 + topMargin;
                      if (sum > 377) {
                        var delta = sum - 377;
                        //var size = heightPx  - ui.size.height -19;
                        if (heightOfP3+topMargin > 350) {
                          $( "#companyInfo3L" ).height();
                        }
                        else if ((heightOfP3 > 150) && (heightOfC3 > 150) ) {
                          $( "#companyInfo3L" ).height();
                        }
                        else {
                           $( "#companyInfo3L" ).css({'top':'20px'});
                        }
                      }  
                    }  
                }
            });

            $('#barcode3L').draggable( {
                containment: 'parent',
                axis: "y",
            } );

          }); //end javascript function()
        
        //for the changing of the font type and size
        $( "#fontTypeCompany" ).change(function() {
            var value = this.value;
            var textArea1 = $('#companyInfoText1L');
            textArea1.css("font-family", value);
            var textArea2 = $('#companyInfoText2L');
            textArea2.css("font-family", value);
            var textArea3 = $('#companyInfoText3L');
            textArea3.css("font-family", value);
            var textArea11 = $('#companyInfoText11L');
            textArea11.css("font-family", value);
            var textArea22 = $('#companyInfoText22L');
            textArea22.css("font-family", value);
            var textArea33 = $('#companyInfoText33L');
            textArea33.css("font-family", value);
        });
        $( "#fontSizeCompany" ).change(function() {
            var value = this.value;
            var textArea1 = $('#companyInfoText1L');
            textArea1.css("font-size", value);
            var textArea2 = $('#companyInfoText2L');
            textArea2.css("font-size", value);
            var textArea3 = $('#companyInfoText3L');
            textArea3.css("font-size", value);
            var textArea11 = $('#companyInfoText11L');
            textArea11.css("font-size", value);
            var textArea22 = $('#companyInfoText22L');
            textArea22.css("font-size", value);
            var textArea33 = $('#companyInfoText33L');
            textArea33.css("font-size", value);
        });

        $( "#fontTypePersonal" ).change(function() {
            var value = this.value;
            var textArea1 = $('#personalInfoText1L');
            textArea1.css("font-family", value);
            var textArea2 = $('#personalInfoText2L');
            textArea2.css("font-family", value);
            var textArea3 = $('#personalInfoText3L');
            textArea3.css("font-family", value);
            var textArea11 = $('#personalInfoText11L');
            textArea11.css("font-family", value);
            var textArea22 = $('#personalInfoText22L');
            textArea22.css("font-family", value);
            var textArea33 = $('#personalInfoText33L');
            textArea33.css("font-family", value);
        });
        $( "#fontSizePersonal" ).change(function() {
            var value = this.value;
            var textArea1 = $('#personalInfoText1L');
            textArea1.css("font-size", value);
            var textArea2 = $('#personalInfoText2L');
            textArea2.css("font-size", value);
            var textArea3 = $('#personalInfoText3L');
            textArea3.css("font-size", value);
            var textArea11 = $('#personalInfoText11L');
            textArea11.css("font-size", value);
            var textArea22 = $('#personalInfoText22L');
            textArea22.css("font-size", value);
            var textArea3 = $('#personalInfoText3L');
            textArea33.css("font-size", value);
        });
        

        function calculateRatio(type) {
          
          var ratio = new Array();
          
          var fontTypeCompany = document.getElementById("fontTypeCompany").value;
          var fontSizeCompany = document.getElementById("fontSizeCompany").value;
          var fontTypePersonal = document.getElementById("fontTypePersonal").value;
          var fontSizePersonal = document.getElementById("fontSizePersonal").value;
          
          switch (fontSizeCompany) {
              case "19px":
                  fontSizeCompany = "0.32cm";
                  break;
              case "27px":
                  fontSizeCompany = "0.43cm";
                  break;
              case "35px":
                  fontSizeCompany = "0.56cm";
                  break;
          }
          
          switch (fontSizePersonal) {
              case "19px":
                  fontSizePersonal = "0.32cm";
                  break;
              case "27px":
                  fontSizePersonal = "0.43cm";
                  break;
              case "35px":
                  fontSizePersonal = "0.56cm";
                  break;
          }

          console.log('font types');
          console.log(fontSizeCompany);
          console.log(fontSizePersonal);

          if (type == 1) {

            //widths and heights
            var outerHeightCompany1 = $("#companyInfo1L").outerHeight();
            var outerHeightTrueCompany1 = $("#companyInfo1L").outerHeight(true);
            var outerWidthCompany1 = $("#companyInfo1L").outerWidth();
            var outerWidthTrueCompany1 = $("#companyInfo1L").outerWidth(true);

            var outerHeightPersonal1 = $("#personalInfo1L").outerHeight();
            var outerHeightTruePersonal1 = $("#personalInfo1L").outerHeight(true);
            var outerWidthPersonal1 = $("#personalInfo1L").outerWidth();
            var outerWidthTruePersonal1 = $("#personalInfo1L").outerWidth(true);

            //position of elements in ui: needed for presicision rendering
            var listItemC = $( "#companyInfo1L" );
            var orderC = 0;
            //var orderC = $( "li" ).index( listItemC );

            var listItemP = $( "#personalInfo1L" );
            var orderP = 1;
            //var orderP = $( "li" ).index( listItemP );

            var listItemB = $( "#barcode1L" );
            var orderB = 3;
            //var orderB = $( "li" ).index( listItemB ); 

            //margins

            //of the card is 8.6cm x 5,4cm
            //barcode's size is 2.4cm x 1.5cm
            //difference full height - barcode height = 3.9cm 
            
            //3.9 cm ..... outerHeight od obeh plus margins oz. outerHeight(true) od obeh

            var c1 = document.getElementById('companyInfo1L');
            var leftC1 = getStyle(c1, 'left');
            //we add 1.5cm (width of the barcode) on the left for option 3
            leftC1 = parseInt(leftC1)*(widthCm/widthPx);
            var topC1 = getStyle(c1, 'top');
            topC1 = parseInt(topC1)*(heightCm/heightPx);
            var widthC1 = (parseInt(outerWidthCompany1)*widthCm)/widthPx;
            var heightC1 = (parseInt(outerHeightCompany1)*heightCm)/heightPx;

            var p1 = document.getElementById('personalInfo1L');
            var leftP1 = getStyle(p1, 'left');
            //we add 1.5cm (width of the barcode) on the left for option 3
            leftP1 = parseInt(leftP1)*(widthCm/widthPx);
            var topP1 = getStyle(p1, 'top');
            topP1 = parseInt(topP1)*(heightCm/heightPx) + heightC1;
            console.log('top P1');
            console.log(topP1);
            var widthP1 = (parseInt(outerWidthPersonal1)*widthCm)/widthPx;
            var heightP1 = (parseInt(outerHeightPersonal1)*heightCm)/heightPx;

            var b1 = document.getElementById('barcode1L');
            var leftB1 = getStyle(b1,'left');
            leftB1 = parseInt(leftB1)*(widthCm/widthPx);

            var b1 = document.getElementById('barcode1L');

            var topB1 = 3.9;
            var widthB1 = 2.4;
            var heightB1 = 1.5;

            sorted = new Array();
            sorted.push({key:'C', value:0});
            sorted.push({key:'P', value:1});
            sorted.push({key:'B', value:2});

            /*sorted.sort(function(a,b) {
              return a.value - br.value;
            });*/

            //text stuff
            var companyTextFinal = $('#companyInfoText1L').val().replace(/\n/g, '<br />');
            var personalTextFinal = $('#personalInfoText1L').val().replace(/\n/g, '<br />');

          
            for (var i=0;i<sorted.length;i++){
              if (sorted[i].key == 'C'){
                sorted[i].value = [leftC1, topC1, widthC1, heightC1, companyTextFinal, fontTypeCompany,fontSizeCompany];
              }
              if (sorted[i].key == 'P'){
                sorted[i].value = [leftP1, topP1, widthP1, heightP1, personalTextFinal, fontTypePersonal, fontSizePersonal];
              }
              if (sorted[i].key == 'B'){
                sorted[i].value = [leftB1, topB1, 2.4, 1.5, "<img src='{% static "barcode.jpg" %}'  />"];
              }
            }

            console.log('vsota');
            console.log(topC1 + topP1 + topB1);

            return sorted;
          }

          if (type == 2) {

            //widths and heights
            var outerHeightCompany2 = $("#companyInfo2L").outerHeight();
            var outerHeightTrueCompany2 = $("#companyInfo2L").outerHeight(true);
            var outerWidthCompany2 = $("#companyInfo2L").outerWidth();
            var outerWidthTrueCompany2 = $("#companyInfo2L").outerWidth(true);

            var outerHeightPersonal2 = $("#personalInfo2L").outerHeight();
            var outerHeightTruePersonal2 = $("#personalInfo2L").outerHeight(true);
            var ofuterWidthPersonal2 = $("#personalInfo2L").outerWidth();
            var outerWidthTruePersonal2 = $("#personalInfo2L").outerWidth(true);

            //position of elements in ui: needed for presicision rendering
            var listItemC2 = $( "#companyInfo2L" );
            //var orderC = $( "li" ).index( listItemC2 );
            var orderC = 0;

            var listItemP2 = $( "#personalInfo2L" );
            //var orderP = $( "li" ).index( listItemP2 );
            var oderP = 1;
            //margins

            //of the card is 8.6cm x 5,4cm
            //barcode's size is 2.4cm x 1.5cm

            //8.6 - 1.5 cm = 7cm

            var c2 = document.getElementById('companyInfo2L');
            var leftC2 = getStyle(c2, 'left');
            //8.4(whole with)-1.5(barcode height - in this case width, because it is on the head positioncm) = 6.9
            leftC2 = parseInt(leftC2)*(widthCm/widthPx);
            var topC2 = getStyle(c2, 'top');
            topC2 = parseInt(topC2)*(heightCm/heightPx);
            var widthC2 = (parseInt(outerWidthTrueCompany2)*widthCm)/widthPx;
            var heightC2 = (parseInt(outerHeightCompany2)*heightCm)/heightPx;

            var p2 = document.getElementById('personalInfo2L');
            var leftP2 = getStyle(p2, 'left');
            leftP2 = parseInt(leftP2)*(widthCm/widthPx)
            var topP2 = getStyle(p2, 'top');
            topP2 = (parseInt(topP2)*(heightCm/heightPx))+heightC2;
            var widthP2 = (parseInt(outerWidthTruePersonal2)*widthCm)/widthPx;
            var heightP2 = (parseInt(outerHeightPersonal2)*heightCm)/heightPx;

            var b2 = document.getElementById('barcode2L');
            var topB2 = getStyle(b2, 'top');
            topB2 = parseInt(topB2)*(heightCm/heightPx);
            console.log('top b2');
            console.log(topB2);

            /*var widthB2 = 3.8;
            var heightB2 = 1.8;*/

            sorted2 = new Array();
            sorted2.push({key:'C', value:orderC});
            sorted2.push({key:'P', value:orderP});

            /*sorted2.sort(function(a,b) {
              return a.value - b.value;
            });*/

            sorted2.push({key:'B', value:2})

            //text stuff
            var companyTextFinal2 = $('#companyInfoText2L').val().replace(/\n/g, '<br />');
            var personalTextFinal2 = $('#personalInfoText2L').val().replace(/\n/g, '<br />');


            for (var i=0;i<sorted2.length;i++){
              if (sorted2[i].key == 'C'){
                sorted2[i].value = [leftC2, topC2, widthC2, heightC2, companyTextFinal2, fontTypeCompany, fontSizeCompany];
              }
              if (sorted2[i].key == 'P'){
                sorted2[i].value = [leftP2, topP2,  widthP2, heightP2, personalTextFinal2, fontTypePersonal, fontSizePersonal];
              }
              //information about the position of the barcode, save on the third spot
              sorted2[2].value = [topB2];
            }
            return sorted2;
          }
          if (type == 3) {
            //widths and heights
            var outerHeightCompany3 = $("#companyInfo3L").outerHeight();
            var outerHeightTrueCompany3 = $("#companyInfo3L").outerHeight(true);
            var outerWidthCompany3 = $("#companyInfo3L").outerWidth();
            var outerWidthTrueCompany3 = $("#companyInfo3L").outerWidth(true);

            var outerHeightPersonal3 = $("#personalInfo3L").outerHeight();
            var outerHeightTruePersonal3 = $("#personalInfo3L").outerHeight(true);
            var outerWidthPersonal3 = $("#personalInfo3L").outerWidth();
            var outerWidthTruePersonal3 = $("#personalInfo3L").outerWidth(true);

            //position of elements in ui: needed for presicision rendering
            var listItemC3 = $( "#companyInfo3L" );
            //var orderC = $( "li" ).index( listItemC3 );
            var orderC = 0;

            var listItemP3 = $( "#personalInfo3L" );
            //var orderP = $( "li" ).index( listItemP3 );
            var orderP = 1;
            //margins
            //of the card is 8.6cm x 5,4cm
            //barcode's size is 2.4cm x 1.5cm

            var c3 = document.getElementById('companyInfo3L');
            var leftC3 = getStyle(c3, 'left');
            //for option three we add the width of the barcode = 1.5cm
            leftC3 = (parseInt(leftC3)*(widthCm/widthPx))+1.5;
            var topC3 = getStyle(c3, 'top');
            topC3 = parseInt(topC3)*(heightCm/heightPx);
            var widthC3 = (parseInt(outerWidthCompany3)*widthCm)/widthPx;
            var heightC3 = (parseInt(outerHeightCompany3)*heightCm)/heightPx;

            var p3 = document.getElementById('personalInfo3L');
            var leftP3 = getStyle(p3, 'left');
            //for option three we add the width of the barcode = 1.5cm
            leftP3 = (parseInt(leftP3)*(widthCm/widthPx))+1.5;
            var topP3 = getStyle(p3, 'top');
            topP3 = (parseInt(topP3)*(heightCm/heightPx))+heightC3;
            var widthP3 = (parseInt(outerWidthPersonal3)*widthCm)/widthPx;
            var heightP3 = (parseInt(outerHeightPersonal3)*heightCm)/heightPx;

            var b3 = document.getElementById('barcode3L');
            var topB3 = document.getElementById('barcode3L').style.top;
            topB3 = parseInt(topB3)*(heightCm/heightPx);

            sorted3 = new Array();
            sorted3.push({key:'C', value:orderC});
            sorted3.push({key:'P', value:orderP});

            /*sorted3.sort(function(a,b) {
              return a.value - b.value;
            });*/

            sorted3.push({key:'B', value:2});

            //text stuff
            var companyTextFinal3 = $('#companyInfoText3L').val().replace(/\n/g, '<br />');
            var personalTextFinal3 = $('#personalInfoText3L').val().replace(/\n/g, '<br />');

            for (var i=0;i<sorted3.length;i++){
              if (sorted3[i].key == 'C'){
                sorted3[i].value = [leftC3, topC3, widthC3, heightC3, companyTextFinal3, fontTypeCompany, fontSizeCompany];
              }
              if (sorted3[i].key == 'P'){
                sorted3[i].value = [leftP3, topP3,  widthP3, heightP3, personalTextFinal3, fontTypePersonal, fontSizePersonal];
              }
              //information about the position of the barcode, save on the third spot
              sorted3[2].value = [topB3];
            }

            return sorted3;
          }
        }

        var getStyle = function (e, styleName) {
            var styleValue = "";
            if(document.defaultView && document.defaultView.getComputedStyle) {
                styleValue = document.defaultView.getComputedStyle(e, "").getPropertyValue(styleName);
            }
            else if(e.currentStyle) {
                styleName = styleName.replace(/\-(\w)/g, function (strMatch, p1) {
                    return p1.toUpperCase();
                });
                styleValue = e.currentStyle[styleName];
            }
            return styleValue;
        }

</script>
{% endblock content %}